---
title: "Prüfungstutorium QM 2 (SoSe ‘18)"
author: "mit Tobi & Lukas"
date: "`r format(lubridate::now(tzone = 'CET'), 'erstellt am %F um %H:%M Uhr')`"
output:
  revealjs::revealjs_presentation:
    mathjax: default
    keep_md: true
    css: "assets/styles.css"
    theme: simple
    highlight: kate
    incremental: false
    transition: slide
    widescreen: yes
    background_transition: slide
    self_contained: false
    fig_height: 7
    fig_retina: 2
    fig_width: 12
    lib_dir: "assets/libs"
    reveal_options:
      slideNumber: true
      progress: true
      history: true
  html_document:
    fig_caption: yes
    fig_width: 9
    number_sections: no
    self_contained: no
    lib_dir: "assets/libs"
    toc: yes
    toc_float: true
    code_folding: show
    include:
      after_body: "assets/_footer.html"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.path = "assets/plots/", fig.align = "center", 
                      fig.retina = 2, echo = F, warning = F, message = F)
library(car)
library(dplyr)
library(ggplot2)
library(knitr)
library(magrittr)
library(MASS)
library(purrr)
library(pwr)
library(sjlabelled)
library(sjmisc)
library(sjPlot)
library(stringr)
library(tadaatoolbox)
library(tidyr)

# 3 digits are enough
options(digits = 3)

# selfmade ggplot-Theme laden und global setzen
theme_set(theme_tadaa(base_size = 16, bg = "#ffffff"))

# no data, no stats
qm <- readRDS("./data/qm_survey_ss2018_r.rds")
```

# Na, auch hier?

## Für die letzte Reihe

### Slides

<span class = "big">[tadaa.click/qm2sose18](https://tadaa.click/qm2sose18)</span>

## Agenda

>1. Aufgaben besprechen <small>Pflichtprogramm</small>
>2. Fragen klären <small>Standard</small>
>3. Angrenzende Theorie besprechen <small>Bonus</small>


## Geronimoooo! /o/ {data-background="img/excited_MSS0COPq80x68.gif" data-background-size="50%"}

# Aufgabe 1:<br />Zusammenhänge

## Aufgabe 1

Prüfen Sie die Hypothese, ob zwischen den Merkmalen **Geschlecht** und **Abschalten** innerhalb der Grundgesamtheit aller **NGO-Schüler\*innen** eine statistische Beziehung existiert. Lassen Sie sich bei der Ausgabe eine Kontigenztabelle mitanzeigen.

**Berechnen Sie den Testwert per Hand.**

## Aufgabe 1: Tabelle & Berechnung

<div id = "left">

```{r a01_tabelle}
sjt.xtab(ngo$geschl, ngo$abschalt, show.exp = TRUE, 
         show.legend = TRUE, show.summary = FALSE)
```
</div>

<div id = "right">
$$\begin{align}
\chi^2 =& \sum \frac{(f_b - f_e)^2}{f_e} \\
\chi^2 =& \frac{(60  - 69)^2}{69} + \frac{(63 - 54)^2}{54} \\+ 
& \frac{(78 - 69)^2}{69} + \frac{(45 - 54)^2}{54} \\
\chi^2 \approx& {\color{red}{\underline{\underline{5.35}}}}
\end{align}$$
</div>

# Aufgabe 2:<br />ein- & zweiseitiges Testen

## Aufgabe 2

Es wird davon ausgegangen, dass das Merkmal "Unterrichtsstunden" in der Grundgesamtheit der 250 NGO-Schüler\*innen $\mathrm{N}(\mu, 1.5)$-verteilt ist. Es ist eine Prüfung der Nullhypothese $\mu = 33$ durchzuführen!

a) Dazu ist eine Zufallsstichprobe vom Umfang 40 zu ziehen und bezüglich der Alternativhypothese $H_1 (\mu_1 < 33)$ ein Signiﬁkanz-Test mit einem Testniveau von $\alpha = 0.05$ durchzuführen! **Erklären Sie, wie sich der Testwert ermitteln lässt.**

b) Zu welchem Ergebnis würde der Inferenzschluss führen, wenn anstelle des _einseitigen_ Tests ein _zweiseitiger_ Test zur Prüfung der Hypothese $\mu = 33$ zu erfolgen hätte?

## Aufgabe 2a: 

**Stichprobe ziehen, Testwert bestimmen**

```{r}
set.seed(2) # Hashtag Determinismus
a02_mean <- ngo %>% sample_n(40) %>% pull(stunzahl) %>% mean
```


<div id = "left">
$$\bar{x} = `r round(a02_mean, 2)`$$
$$\sigma_x := 1.5$$
</div>
<div id = "right">
$$\begin{align}
z =& \frac{\bar{x} - \mu_0}{\frac{\sigma_x}{\sqrt{n}}} \\
z =& \frac{`r round(a02_mean, 2)` - 33}{\frac{1.5}{\sqrt{40}}} \\
z \approx& {\color{red}{\underline{\underline{`r round((a02_mean - 33) / (1.5/sqrt(40)), 2)`}}}}
\end{align}$$
</div>

## Aufgabe 2a: Inferenzschluss in bunt

_Kritischer Wert_ bei $\alpha = 5\%$, einseitig: -1.64

```{r a02a_bunt}
ztest <- (a02_mean - 33) / (1.5 / sqrt(40))

ggplot(data = NULL, aes(x = -3.3:3.3)) +
  stat_function(fun = dnorm, geom = "density", color = "black") +
  geom_vline(aes(xintercept = qnorm(.05)), color = "red") +
  geom_vline(aes(xintercept = ztest), color = "blue") +
  annotate("text", x = qnorm(.05), y = 0.35, color = "dark red", size = 5,
           hjust = 1,
           label = paste("z[krit]", "==", round(qnorm(.05), 2)), parse = T) +
  annotate("text", x = ztest, y = 0.25, color = "dark blue", size = 7,
           hjust = 0,
           label = paste("z[test]", "==", round(ztest, 2)), parse = T) +
  labs(x = NULL, y = NULL) +
  theme_readthedown(base_family = "Palatino")
```

## Aufgabe 2b: same same, but zweiseitig

_Kritischer Werte_ bei $\alpha = 5\%$, zweiseitig: -1.96 & 1.96

```{r a02b_bunt}
ggplot(data = NULL, aes(x = -3.3:3.3)) +
  stat_function(fun = dnorm, geom = "density", color = "black") +
  geom_vline(aes(xintercept = c(qnorm(.025), qnorm(.975))), color = "red") +
  geom_vline(aes(xintercept = ztest), color = "blue") +
  annotate("label", x = qnorm(.025), y = 0.35, color = "dark red", size = 5,
           hjust = 1,
           label = paste("z[krit]", "==", round(qnorm(.025), 2)), parse = T) +
  annotate("label", x = qnorm(.975), y = 0.35, color = "dark red", size = 5,
           hjust = 0,
           label = paste("z[krit]", "==", round(qnorm(.975), 2)), parse = T) +
  annotate("label", x = ztest, y = 0.25, color = "dark blue", size = 7,
           hjust = 0,
           label = paste("z[test]", "==", round(ztest, 2)), parse = T) +
  labs(x = NULL, y = NULL) +
  theme_readthedown(base_family = "Palatino")
```

# Aufgabe 3:<br />Poweranalyse (einsitiger t-Test)

## Aufgabe 3

Durch einen _einseitigen t-Test_ soll eine innerhalb einer Nullhypothese postulierte Mitte auf der Basis der Risiken $\alpha=0.05$ und $\beta=0.15$ – bei der Wahl einer Effektgröße von **-0.6** – teststatistisch abgesichert werden! Wie groß ist der **optimale Stichprobenumfang** und welche Bedeutung besitzt er? Wie **verändert** sich der optimale Stichprobenumfang, wenn Sie $\beta$ _erhöhen_ oder wenn die Effektgröße _verringert_ wird? Warum ist das so?

## Aufgabe 3: $\beta$

```{r a03_intro}
ggplot(data = NULL, aes(x = -4:7)) + 
  stat_function(fun = dnorm, args = list(mean = 0)) +
  stat_function(fun = dnorm, args = list(mean = 3)) +
  geom_area(aes(x = seq(1.64, 7, .01), y = dnorm(seq(1.64, 7, .01), 3)), fill = "red", alpha = .4) +
  geom_area(aes(x = seq(1.64, 7, .01), y = dnorm(seq(1.64, 7, .01))), fill = "blue", alpha = .4) +
  geom_area(aes(x = seq(-4, 1.64, .01), y = dnorm(seq(-4, 1.64, .01))), fill = "green", alpha = .4) +
  geom_area(aes(x = seq(-1, 1.64, .01), y = dnorm(seq(-1, 1.64, .01), 3)), fill = "orange", alpha = .4) +
  scale_x_continuous(breaks = seq(-5, 10, 1)) + 
  annotate("text", x = 0, y = .2, label = "H[0]", parse = TRUE, size = 6, family = "Palatino") +
  annotate("text", x = 3, y = .2, label = "H[1]", parse = TRUE, size = 6, family = "Palatino") +
  annotate("text", x = 0, y = .1, label = "1-alpha", parse = TRUE, size = 6, family = "Palatino") +
  annotate("text", x = 3, y = .1, label = "1-beta", parse = TRUE, size = 6, family = "Palatino") +
  annotate("text", x = 2, y = .025, label = "alpha", parse = TRUE, size = 4, family = "Palatino") +
  annotate("text", x = 1.1, y = .025, label = "beta", parse = TRUE, size = 4, family = "Palatino") +
  labs(x = "x", y = expression(P(x)), title = expression("N(0,1) & N(3,1)")) + 
  theme_readthedown(base_family = "Palatino") + 
  theme(panel.grid.major = element_line(size = 0.1), 
        panel.grid.minor = element_line(linetype = "blank"))
```

## Aufgabe 3: A priori (Code)

```{r a03_solution, echo = T}
pwr.t.test(d = -0.6, sig.level = 0.05, power = 1 - 0.15, 
           type = "one.sample", alternative = "less")
```

## Aufgabe 3: Needs Rechnung zu Fuss

## Aufgabe 3: Ch-ch-changes

Wie **verändert** sich der optimale Stichprobenumfang, wenn Sie $\beta$ _erhöhen_ oder wenn die Effektgröße _verringert_ wird? Warum ist das so?

<p class="fragment">Wenn Beta _steigt_, dann _____ n.</p>
<p class="fragment">Wenn die Effektgröße _sinkt_, dann _____ n.</p>

<p class="fragment big">BUT WHY?!? ლ(ಠ_ಠლ)</p>

# Aufgabe 4:<br />Konfidenzintervalle

## Aufgabe 4

Für die aus einer Zufallsauswahl vom Umfang **36** resultierenden Werte eines **normalverteilten Merkmals** erhält man den Mittelwert **33** und den Standardfehler **1.2**. Gib für $\mu$ das zugehörige **95%-Konfidenzintervall** an und erklären Sie die Bedeutung dieses Konfidenzintervalls! Diskutieren Sie die Vor- und Nachteile, die sich beim Einsatz eines Signifikanz-Tests bzw. eines Konfidenzintervalls ergeben!

## Aufgabe 4: Berechnung

${CI} = \bar{x} \pm \sigma_\bar{x} \cdot w_{krit}$

- $w_{krit} \approx `r qnorm(0.975)`$ (bei $\alpha$ = 5%)
- $CI_{lower} = 33 - 1.2 \cdot `r round(qnorm(0.975), 3)` \approx `r 33 - 1.2 * qnorm(0.975)`$
- $CI_{upper} = 33 + 1.2 \cdot `r round(qnorm(0.975), 3)` \approx `r 33 + 1.2 * qnorm(0.975)`$

```{r a04_plot1, fig.height= 3, fig.width=7}
ki <- c(33 - 1.2 * qnorm(0.975), 33 + 1.2 * qnorm(0.975))
df <- data_frame(x = seq(29, 37, .01), y = dnorm(x, mean = 33, sd = 1.2))

ggplot(data = df, aes(x = x, y = y)) +
  geom_line() +
  geom_vline(xintercept = ki[[1]], linetype = "dotdash") +
  geom_vline(xintercept = ki[[2]], linetype = "dotdash") +
  geom_area(data = filter(df, x < ki[2], x > ki[1]), aes(x, y), fill = "green", alpha = .5) +
  geom_area(data = filter(df, x > ki[2]), aes(x, y), fill = "red", alpha = .5) +
  geom_area(data = filter(df, x < ki[1]), aes(x, y), fill = "red", alpha = .5) +
  scale_x_continuous(breaks = seq(0, 100, 1), minor_breaks = seq(0, 100, .5)) +
  annotate("label", x = ki[1]-0.4, y = 0.02, label = "frac(alpha,2)", parse = T) +
  annotate("label", x = ki[2]+0.4, y = 0.02, label = "frac(alpha,2)", parse = T) +
  annotate("label", x = 33, y = 0.1, label = "1 - alpha == 0.95", parse = T) +
  labs(title = expression(N(33, 1.2)), x = "x", y = expression(P(x))) +
  theme_readthedown()
```

## Wat issen Konfidenzintervall

```{r a04_plot2}
tenk <- rnorm(10000, 100, 15)

map_df(seq_len(20), function(x){
  tibble(smpl = x, val = sample(tenk, 100))
  }) %>% 
  group_by(smpl) %>% 
  summarise(
    mean  = mean(val),
    upper = mean + (sd(val)/sqrt(100)) * 1.96,
    lower = mean - (sd(val)/sqrt(100)) * 1.96
  ) %>% 
  ungroup() %>% 
  ggplot(aes(x = smpl, y = mean, ymin = lower, ymax = upper)) +
    geom_hline(aes(color = "true population mean", yintercept = mean(tenk)), lty = "dotdash") +
    geom_pointrange(size = .4, shape = 23, fill = "white") +
    scale_y_continuous(limits = c(90, 110)) +
    scale_color_manual(values = "red") +
    labs(color = NULL, x = "Stichprobe", y = "IQ",
         title = "95%-Konfidenzintervalle", subtitle = "n = 100 für alle Stichproben") +
    coord_flip() +
    theme(legend.position = "top")
```

# Aufgabe 5:<br />Test-Auswahl

## Aufgabe 5

Berechnen Sie einen geeigneten Test für die Fragestellung, ob die Verteilungen des Alkoholkkonsums bei ernährungsbewussten StudentInnen (Vegetarier) und der ﬂeischkonsumierenden StudentInnen gleich sind. Prüfen Sie einseitig die Annahme, dass die Tatsache Vegetarier zu sein, sich positiv auf einen geringeren Alkoholkonsum auswirkt. Wie kommt der resultierende Testwert zustande?

## {data-background="https://tobi.tadaa-data.de/qm/pics/nhst_wahl.png" data-background-size="60%"}

## Normalverteilung?

Test  | _p_-Wert
------|--------
Kolmogorov-Smirnoff | `r pval_string(ks.test(as.numeric(qm$alkohol), "pnorm")$p.value)`
Chi²-Anpassungstest | `r pval_string(nortest::pearson.test(as.numeric(qm$alkohol), n.classes = 5)$p.value)`
Shapiro-Wilk  | `r pval_string(shapiro.test(as.numeric(qm$alkohol))$p.value)`

```{r a05_bars1, fig.height= 3, fig.width=7}
ggplot(qm, aes(alkohol)) +
  geom_bar() +
  labs(x = "Alkoholkonsum", y = "Anzahl")
```

## Gruppengröße und Varianzen

```{r a05_bars2, fig.height= 4, fig.width=7}
omni_veg <- qm %>% 
  filter(str_detect(ernaehrung, "Veget|Omni")) %>% 
  mutate(alk_num = as.numeric(alkohol),
         ernaehrung = droplevels(ernaehrung))

ggplot(omni_veg, aes(ernaehrung, fill = ernaehrung)) +
  geom_bar() +
  scale_fill_brewer(palette = "Dark2", direction = -1) +
  labs(x = "Ernährungseinstellung", y = "Anzahl",
       fill = "Ernährung")

a05_levene <- pval_string(leveneTest(omni_veg$alk_num ~ omni_veg$ernaehrung)$`Pr(>F)`[1])
```

Levene-Test _p_-Wert: `r a05_levene`

## Sieger-Test

<p class="fragment">**Two-Sample t-Test!**</p>

<div class="fragment">
```{r a05_t_test}
tadaa_t.test(omni_veg, alk_num, ernaehrung, var.equal = TRUE,
             direction = "greater", print = "markdown")
```
</div>

## There's one more thing...

Wie kommt der resultierende Testwert zustande?


$$
t_{(n_1 + n_2 - 2)} = \frac{\mu_1 - \mu_2}{s_{\bar{x}_1-\bar{x}_2}}
$$

Wobei für $s_{\bar{x_1} - \bar{x_2}}$ gilt:

$$s_{\bar{x}_1 - \bar{x}_2} = \sqrt{S^2_p (\frac{1}{n_1} + \frac{1}{n_2})}$$

<div class="col2">
_n_ gleich groß:

$$s^2_p = \frac{s^2_1 + s^2_2}{2}$$

_n_ ungleich:

$$s^2_p = \frac{(n_1 - 1)s^2_1 + (n_2 - 1)s^2_2}{(n_1 - 1) + (n_2 - 1)}$$
</div>

# Aufgabe 6:<br />Effektgrößen

## Aufgabe 6

a) Die Hypothese, dass es für die Schüler\*innen keine jahrgangsstufenspeziﬁschen Unterschiede im Hinblick auf die Anzahl von Wochentagen gibt, an denen für das Fach „Deutsch“ gelernt wird, ist mit den für die NGO-Schüler\*innen erhobenen Daten teststatistisch zu prüfen!

b) Falls ein signiﬁkantes Testergebnis vorliegt, ist die empirische Eﬀektgröße zu ermitteln und zu überprüfen, zwischen welchen Jahrgängen Unterschiede bestehen könnten!

# Aufgabe 7:<br />Tagelang nur NHST.

## Aufgabe 7

In 3 Kursen (A, B, C) der 11. Jahrgangsstufe werden Schüler und Schüler\*innen nach unterschiedlichen Methoden unterrichtet. Aus jedem der 3 Kurse werden jeweils 9 Schüler\*innen durch eine Zufallsauswahl bestimmt. Bei einem abschließenden Leistungstest werden die folgenden Ergebnisse erzielt:

Schüler\*innen des Kurses A: `10, 19, 21, 24, 22, 16, 11, 21, 19`  
Schüler\*innen des Kurses B: `16, 19, 18, 16, 11, 19, 19, 16, 21`  
Schüler\*innen des Kurses C: `22, 17, 12, 20, 16, 21, 22, 11, 21`  

Wenden Sie einen geeigneten Test an¹.

<br /><br />
<p class="small">¹ Anm. der Redaktion: _"...um zu überprüfen, ob sich die Testergebnise Unterscheiden."_</p>

# Aufgabe 8

## Aufgabe 8

Auf dem Testniveau "$\alpha$ = 0,05" ist zu prüfen, ob bei den Schüler\*innen Mittelwertunterschiede bei den Merkmalen "Mathe" und "Deutsch" festzustellen sind! Dazu ist zu unterstellen, dass beide Merkmale innerhalb der Grundgesamtheit der 125 NGO-Schüler\*innen normalverteilt sind! Es ist ein zweiseitiger Test durchzuführen und der Stichprobenumfang so zu wählen, dass ein mittlerer Effekt mit einer Wahrscheinlichkeit von mindestens „0,85“ aufgedeckt werden kann. Wie viele Stichprobenelemente wären für die Durchführung eines einseitigen Tests angemessen gewesen?

# Aufgabe 9
## Aufgabe 9

Auf dem Testniveau von "=0,01" ist zu prüfen, ob geschlechtsspeziﬁsche Mittelwertunterschiede beim Merkmal "Deutsch" festzustellen sind! Dazu ist zu unterstellen, dass das Merkmal "Deutsch" innerhalb der beiden Grundgesamtheiten der jeweiligen 125 NGO-Schüler und Schüler\*innen normalverteilt ist! Zur Prüfung der zweiseitigen Fragestellung ist der Umfang der beiden Zufallsstichproben so zu wählen, dass ein durch die Eﬀektgröße „0,9“ beschriebener Eﬀekt mit einer Wahrscheinlichkeit von mindestens „0,85“ aufgedeckt werden kann! Wie berechnet sich der Testwert?

# Aufgabe 10
## Aufgabe 10

a) Es ist zu prüfen, ob die These „Das Geschlecht und die Jahrgangsstufe üben einen Interaktionseﬀekt auf „Deutsch“ aus, und das Geschlecht wirkt nicht als Haupteﬀekt.“ akzeptabel ist!

b) Welche Voraussetzungen sind zu erfüllen, damit eine 2-faktorielle Varianzanalyse durchgeführt werden kann?

c) Welche Feststellungen lassen sich – auf der Basis eines Testniveaus von "=0,05" - über potentiell wirksame Eﬀekte treﬀen?

d) Wie viele Schüler\*innen wären für jede der 6 Zellen des Versuchsplans erforderlich gewesen, um – auf der Basis des Testniveaus "=0,05" - einen tatsächlich vorliegenden, nach Cohen als „stark“ taxierten Interaktionseﬀekt mit einer Mindest-Teststärke von „0,8“ „aufdecken“ zu können?

# Aufgabe 11
## Aufgabe 11

Wählen Sie selbst für Sie interessante Variablen einmal für eine Varianzanalyse, einmal für den Kruskal-Wallis-Test & einmal für den Wilcoxon-Test aus dem Psychologie-Datensatz aus und interpretieren Sie die Daten.

# Aufgabe 12

## Lernhilfe

Nennen Sie die Voraussetzungen aller behandelter Signifikanztests und ihrer Teststatistiken. Erstellen Sie hierzu eine Übersicht. Schauen Sie sich Ausgabetabellen aller Signifikanztests an und legen Sie fest, was einzelne Werte aussagen, wie sie ggfs. berechnet werden und wie im Besonderen Testwerte zustande kommen.

# Aufgabenblock: Berechnungen per Hand

Meeeeeh

# Aufgabe 13 
## Aufgabe 13

Berechnen Sie auf Basis folgender Daten die Binnenvarianz, die Treatmentvarianz, den F-Wert und den kritischen Wert:

![](https://dump.jemu.name/2018-07-i2sn7a5mh9maxk4.png)

Zu welchem Inferenzschluss gelangen Sie?

# Aufgabe 14 
## Aufgabe 14

Sie haben folgende Testwerte von 6 frühgeborenen Kindern bezüglich ihrer motorischen Fähigkeiten vorliegen: 7, 8, 11, 9, 8, 10. Welches Intervall enthält mit einer Mutmaßlichkeit von 99% den wahren Mittelwert der motorischen Fähigkeiten? Erklären Sie: Wie ist es möglich anhand des Konﬁdenzintervalls eine Aussage über die Mutmaßlichkeeit einer Mitte zu treﬀen?

# Aufgabe 15 
## Aufgabe 15

Nutzen Sie die Standardnormalverteilungstabelle in Studip. Wiederholen Sie die Kenntnisse aus der Deskriptiven Statistik, indem Sie die Wahrscheinlichkeiten von Werten in folgenden Bereichen berechnen:

a) Wie wahrscheinlich ist es, dass Werte im Bereich 2 bis 2,5; im Bereich 0,75 bis 1,3 und $-\infty$ bis -0,2 liegen?

# Aufgabe 16
## Aufgabe 16

10 Frauen in der Alterskategorie 40+ wurden in einer Studie über ihre sportlichen Aktivitäten befragt. Jede dieser Frauen war in den letzten Monaten als Mitglied im Fitnessstudio registriert. Berechnen Sie auf Basis der nachfolgenden Daten den Standardfehler und die Standardabweichung. Vergleichen Sie die Werte.

![](https://dump.jemu.name/2018-07-myzl6vvuf09tw32.png)

# Klar soweit?

## Nochmal zum nachlesen

<span class = "big">[tadaa.click/qm2sose18](https://tadaa.click/qm1ws1718)</span>

## 

Das war's, wir sind raus.

![](img/mic-drop.gif)

**Viel Erfolg!!**